N_CTX,Provider Name,provider,N_HEADS_query,D_HEAD,BATCH,mode,causal,mqa_eval,Time (s),Peak Memory (GB),TFLOP/s,Fwd Max Abs Diff (vs SDPA),Fwd Avg % Err (vs SDPA),Bwd dQ Max Abs Diff (vs SDPA),Bwd dK Max Abs Diff (vs SDPA),Bwd dV Max Abs Diff (vs SDPA),Bwd dQ Avg % Err (vs SDPA),Bwd dK Avg % Err (vs SDPA),Bwd dV Avg % Err (vs SDPA)
1024,Custom MQA Kernel,custom_mqa_kernel,8,64,4,fwd,True,True,0.00034371467183033627,0.259033203125,12.495734537977688,0.001953125,0.26073455810546875,,,,,,
1024,Naive Pytorch MQA,naive_mqa_pytorch,8,64,4,fwd,True,True,0.004941653410593669,0.4864501953125,0.8691356797287045,0.001953125,0.16565322875976562,,,,,,
1024,Pytorch SDPA (K/V Expanded for MQA),sdpa_expanded_for_mqa,8,64,4,fwd,True,True,0.0002551245721323149,0.2736825942993164,16.83478490567544,0.0,0.0,,,,,,
1024,Custom Kernel MHA (K/V Expanded for MQA),custom_kernel_mha_expanded_for_mqa,8,64,4,fwd,True,True,0.00037565066665410995,0.2738037109375,11.433407889981737,0.001953125,0.2582550048828125,,,,,,
1024,Pip FlashAttention MQA (Broadcast),pip_flashattention_broadcast_mqa,8,64,4,fwd,True,True,0.0005992832005023955,0.2834486961364746,7.166840806482496,3.81640625,92.3828125,,,,,,
2048,Custom MQA Kernel,custom_mqa_kernel,8,64,4,fwd,True,True,0.0011621039807796479,0.2760009765625,14.783418238077232,0.00244140625,0.32806396484375,,,,,,
2048,Naive Pytorch MQA,naive_mqa_pytorch,8,64,4,fwd,True,True,0.020529056549072267,1.1544189453125,0.8368562453385798,0.001953125,0.1598358154296875,,,,,,
2048,Pytorch SDPA (K/V Expanded for MQA),sdpa_expanded_for_mqa,8,64,4,fwd,True,True,0.0008347448905309041,0.2894296646118164,20.58098154164618,0.0,0.0,,,,,,
2048,Custom Kernel MHA (K/V Expanded for MQA),custom_kernel_mha_expanded_for_mqa,8,64,4,fwd,True,True,0.0012515159994363784,0.2896728515625,13.727246948290691,0.001953125,0.32520294189453125,,,,,,
2048,Pip FlashAttention MQA (Broadcast),pip_flashattention_broadcast_mqa,8,64,4,fwd,True,True,0.0018369440038998922,0.3089613914489746,9.352418553601295,3.595703125,92.041015625,,,,,,
4096,Custom MQA Kernel,custom_mqa_kernel,8,64,4,fwd,True,True,0.004194773197174072,0.2940673828125,16.382167403542777,0.001953125,0.42266845703125,,,,,,
4096,Naive Pytorch MQA,naive_mqa_pytorch,8,64,4,fwd,True,True,,,,,,,,,,,
4096,Pytorch SDPA (K/V Expanded for MQA),sdpa_expanded_for_mqa,8,64,4,fwd,True,True,0.0030507359504699707,0.3209238052368164,22.525540673362325,0.0,0.0,,,,,,
4096,Custom Kernel MHA (K/V Expanded for MQA),custom_kernel_mha_expanded_for_mqa,8,64,4,fwd,True,True,0.004501322746276856,0.3214111328125,15.266507337835176,0.001953125,0.421142578125,,,,,,
4096,Pip FlashAttention MQA (Broadcast),pip_flashattention_broadcast_mqa,8,64,4,fwd,True,True,0.006407040119171143,0.3599867820739746,10.725619858439408,3.716796875,92.431640625,,,,,,
8192,Custom MQA Kernel,custom_mqa_kernel,8,64,4,fwd,True,True,0.01626150321960449,0.3302001953125,16.903597609144374,0.001953125,0.545501708984375,,,,,,
8192,Naive Pytorch MQA,naive_mqa_pytorch,8,64,4,fwd,True,True,,,,,,,,,,,
8192,Pytorch SDPA (K/V Expanded for MQA),sdpa_expanded_for_mqa,8,64,4,fwd,True,True,0.011581279754638673,0.3839120864868164,23.73467464456185,0.0,0.0,,,,,,
8192,Custom Kernel MHA (K/V Expanded for MQA),custom_kernel_mha_expanded_for_mqa,8,64,4,fwd,True,True,0.017132095336914063,0.3848876953125,16.044616933208864,0.00244140625,0.54473876953125,,,,,,
8192,Pip FlashAttention MQA (Broadcast),pip_flashattention_broadcast_mqa,8,64,4,fwd,True,True,0.023690431594848634,0.4620375633239746,11.602908365914736,3.80078125,92.138671875,,,,,,
