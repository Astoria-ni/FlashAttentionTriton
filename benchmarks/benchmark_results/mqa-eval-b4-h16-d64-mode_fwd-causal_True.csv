N_CTX,Provider Name,provider,N_HEADS_query,D_HEAD,BATCH,mode,causal,mqa_eval,Time (s),Peak Memory (GB),TFLOP/s,Fwd Max Abs Diff (vs SDPA),Fwd Avg % Err (vs SDPA),Bwd dQ Max Abs Diff (vs SDPA),Bwd dK Max Abs Diff (vs SDPA),Bwd dV Max Abs Diff (vs SDPA),Bwd dQ Avg % Err (vs SDPA),Bwd dK Avg % Err (vs SDPA),Bwd dV Avg % Err (vs SDPA)
1024,Custom MQA Kernel,custom_mqa_kernel,16,64,4,fwd,True,True,0.0006678559958934784,0.26708984375,12.861956237299509,0.001953125,0.25482177734375,,,,,,
1024,Naive Pytorch MQA,naive_mqa_pytorch,16,64,4,fwd,True,True,0.009774368286132812,0.7130126953125,0.8788224814678608,0.001953125,0.16183853149414062,,,,,,
1024,Pytorch SDPA (K/V Expanded for MQA),sdpa_expanded_for_mqa,16,64,4,fwd,True,True,0.0004791185449470173,0.2894296646118164,17.92862055245619,0.0,0.0,,,,,,
1024,Custom Kernel MHA (K/V Expanded for MQA),custom_kernel_mha_expanded_for_mqa,16,64,4,fwd,True,True,0.0007307295978069305,0.2896728515625,11.755284879359145,0.001953125,0.25653839111328125,,,,,,
1024,Pip FlashAttention MQA (Broadcast),pip_flashattention_broadcast_mqa,16,64,4,fwd,True,True,0.0010865360200405121,0.3070082664489746,7.905798274114943,3.69921875,95.458984375,,,,,,
2048,Custom MQA Kernel,custom_mqa_kernel,16,64,4,fwd,True,True,0.0022661247730255125,0.2921142578125,15.16233297345149,0.001953125,0.32787322998046875,,,,,,
2048,Naive Pytorch MQA,naive_mqa_pytorch,16,64,4,fwd,True,True,0.040841793060302736,2.0450439453125,0.8412886847859004,0.001953125,0.16126632690429688,,,,,,
2048,Pytorch SDPA (K/V Expanded for MQA),sdpa_expanded_for_mqa,16,64,4,fwd,True,True,0.0016424906849861144,0.3209238052368164,20.919289638644422,0.0,0.0,,,,,,
2048,Custom Kernel MHA (K/V Expanded for MQA),custom_kernel_mha_expanded_for_mqa,16,64,4,fwd,True,True,0.002443769598007202,0.3214111328125,14.060138237262226,0.001953125,0.3269195556640625,,,,,,
2048,Pip FlashAttention MQA (Broadcast),pip_flashattention_broadcast_mqa,16,64,4,fwd,True,True,0.0034837999939918516,0.3560805320739746,9.862718418754428,3.97265625,95.654296875,,,,,,
4096,Custom MQA Kernel,custom_mqa_kernel,16,64,4,fwd,True,True,0.008287504196166992,0.3262939453125,16.583877391647793,0.0029296875,0.4215240478515625,,,,,,
4096,Naive Pytorch MQA,naive_mqa_pytorch,16,64,4,fwd,True,True,,,,,,,,,,,
4096,Pytorch SDPA (K/V Expanded for MQA),sdpa_expanded_for_mqa,16,64,4,fwd,True,True,0.00602294397354126,0.3839120864868164,22.819231604306484,0.0,0.0,,,,,,
4096,Custom Kernel MHA (K/V Expanded for MQA),custom_kernel_mha_expanded_for_mqa,16,64,4,fwd,True,True,0.008916319847106934,0.3848876953125,15.41431395785949,0.00244140625,0.4184722900390625,,,,,,
4096,Pip FlashAttention MQA (Broadcast),pip_flashattention_broadcast_mqa,16,64,4,fwd,True,True,0.01229526424407959,0.4542250633239746,11.178202496801118,3.908203125,95.703125,,,,,,
8192,Custom MQA Kernel,custom_mqa_kernel,16,64,4,fwd,True,True,0.03225363159179687,0.3946533203125,17.044772534322007,0.0020751953125,0.5462646484375,,,,,,
8192,Naive Pytorch MQA,naive_mqa_pytorch,16,64,4,fwd,True,True,,,,,,,,,,,
8192,Pytorch SDPA (K/V Expanded for MQA),sdpa_expanded_for_mqa,16,64,4,fwd,True,True,0.023053695678710937,0.5098886489868164,23.8467541842185,0.0,0.0,,,,,,
8192,Custom Kernel MHA (K/V Expanded for MQA),custom_kernel_mha_expanded_for_mqa,16,64,4,fwd,True,True,0.0340846061706543,0.5118408203125,16.12915258974948,0.001953125,0.543975830078125,,,,,,
8192,Pip FlashAttention MQA (Broadcast),pip_flashattention_broadcast_mqa,16,64,4,fwd,True,True,0.045813407897949215,0.6505141258239746,11.999889096061095,3.681640625,95.703125,,,,,,
