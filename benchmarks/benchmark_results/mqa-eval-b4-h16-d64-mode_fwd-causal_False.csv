N_CTX,Provider Name,provider,N_HEADS_query,D_HEAD,BATCH,mode,causal,mqa_eval,Time (s),Peak Memory (GB),TFLOP/s,Fwd Max Abs Diff (vs SDPA),Fwd Avg % Err (vs SDPA),Bwd dQ Max Abs Diff (vs SDPA),Bwd dK Max Abs Diff (vs SDPA),Bwd dV Max Abs Diff (vs SDPA),Bwd dQ Avg % Err (vs SDPA),Bwd dK Avg % Err (vs SDPA),Bwd dV Avg % Err (vs SDPA)
1024,Custom MQA Kernel,custom_mqa_kernel,16,64,4,fwd,False,True,0.0010554760098457337,0.2750244140625,16.27689215457486,0.0013427734375,0.3398895263671875,,,,,,
1024,Naive Pytorch MQA,naive_mqa_pytorch,16,64,4,fwd,False,True,0.0074730880260467526,0.7120361328125,2.2988982766054895,0.00048828125,0.15916824340820312,,,,,,
1024,Pytorch SDPA (K/V Expanded for MQA),sdpa_expanded_for_mqa,16,64,4,fwd,False,True,0.0007531911068492465,0.2894296646118164,22.80944242141537,0.0,0.0,,,,,,
1024,Custom Kernel MHA (K/V Expanded for MQA),custom_kernel_mha_expanded_for_mqa,16,64,4,fwd,False,True,0.0010622240006923675,0.2896728515625,16.17348993508149,0.0029296875,0.34160614013671875,,,,,,
1024,Pip FlashAttention MQA (Broadcast),pip_flashattention_broadcast_mqa,16,64,4,fwd,False,True,0.0015306605781827654,0.3070082664489746,11.223826777061396,1.8671875,95.1171875,,,,,,
2048,Custom MQA Kernel,custom_mqa_kernel,16,64,4,fwd,False,True,0.003446087956428528,0.2921142578125,19.94130086198374,0.001708984375,0.443267822265625,,,,,,
2048,Naive Pytorch MQA,naive_mqa_pytorch,16,64,4,fwd,False,True,0.03029971122741699,2.0411376953125,2.267991144213233,0.000732421875,0.15382766723632812,,,,,,
2048,Pytorch SDPA (K/V Expanded for MQA),sdpa_expanded_for_mqa,16,64,4,fwd,False,True,0.0028824480175971986,0.3209238052368164,23.840664711547646,0.0,0.0,,,,,,
2048,Custom Kernel MHA (K/V Expanded for MQA),custom_kernel_mha_expanded_for_mqa,16,64,4,fwd,False,True,0.003885215997695923,0.3214111328125,17.687427617088264,0.0013427734375,0.443267822265625,,,,,,
2048,Pip FlashAttention MQA (Broadcast),pip_flashattention_broadcast_mqa,16,64,4,fwd,False,True,0.005681408166885376,0.3560805320739746,12.095500748659102,1.65625,95.068359375,,,,,,
4096,Custom MQA Kernel,custom_mqa_kernel,16,64,4,fwd,False,True,0.01342198371887207,0.3262939453125,20.47967816839966,0.00341796875,0.5817413330078125,,,,,,
4096,Naive Pytorch MQA,naive_mqa_pytorch,16,64,4,fwd,False,True,,,,,,,,,,,
4096,Pytorch SDPA (K/V Expanded for MQA),sdpa_expanded_for_mqa,16,64,4,fwd,False,True,0.011228256225585938,0.3839120864868164,24.48090793632167,0.0,0.0,,,,,,
4096,Custom Kernel MHA (K/V Expanded for MQA),custom_kernel_mha_expanded_for_mqa,16,64,4,fwd,False,True,0.014832159996032716,0.3848876953125,18.532560801496473,0.001708984375,0.5771636962890625,,,,,,
4096,Pip FlashAttention MQA (Broadcast),pip_flashattention_broadcast_mqa,16,64,4,fwd,False,True,0.021485183715820314,0.4542250633239746,12.79383553707281,1.1484375,95.1171875,,,,,,
8192,Custom MQA Kernel,custom_mqa_kernel,16,64,4,fwd,False,True,0.05446246337890625,0.3946533203125,20.188429967379143,0.00164794921875,0.760650634765625,,,,,,
8192,Naive Pytorch MQA,naive_mqa_pytorch,16,64,4,fwd,False,True,,,,,,,,,,,
8192,Pytorch SDPA (K/V Expanded for MQA),sdpa_expanded_for_mqa,16,64,4,fwd,False,True,0.04437807846069336,0.5098886489868164,24.776008018234986,0.0,0.0,,,,,,
8192,Custom Kernel MHA (K/V Expanded for MQA),custom_kernel_mha_expanded_for_mqa,16,64,4,fwd,False,True,0.05787398529052734,0.5118408203125,18.99837417894159,0.00164794921875,0.7476806640625,,,,,,
8192,Pip FlashAttention MQA (Broadcast),pip_flashattention_broadcast_mqa,16,64,4,fwd,False,True,0.08329225921630859,0.6505141258239746,13.200645991851259,1.06640625,95.166015625,,,,,,
