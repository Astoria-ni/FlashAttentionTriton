N_CTX,Provider Name,provider,N_HEADS_query,D_HEAD,BATCH,mode,causal,mqa_eval,Time (s),Peak Memory (GB),TFLOP/s,Fwd Max Abs Diff (vs SDPA),Fwd Avg % Err (vs SDPA),Bwd dQ Max Abs Diff (vs SDPA),Bwd dK Max Abs Diff (vs SDPA),Bwd dV Max Abs Diff (vs SDPA),Bwd dQ Avg % Err (vs SDPA),Bwd dK Avg % Err (vs SDPA),Bwd dV Avg % Err (vs SDPA)
1024,Custom MQA Kernel,custom_mqa_kernel,8,64,4,fwd,False,True,0.00053835636919195,0.2669677734375,15.955852077858994,0.001708984375,0.34542083740234375,,,,,,
1024,Naive Pytorch MQA,naive_mqa_pytorch,8,64,4,fwd,False,True,0.003772655963897705,0.4854736328125,2.276893168685687,0.000732421875,0.16469955444335938,,,,,,
1024,Pytorch SDPA (K/V Expanded for MQA),sdpa_expanded_for_mqa,8,64,4,fwd,False,True,0.0003911626661817233,0.2736825942993164,21.96000624458714,0.0,0.0,,,,,,
1024,Custom Kernel MHA (K/V Expanded for MQA),custom_kernel_mha_expanded_for_mqa,8,64,4,fwd,False,True,0.0005520989082076333,0.2738037109375,15.558687880559072,0.00146484375,0.34046173095703125,,,,,,
1024,Pip FlashAttention MQA (Broadcast),pip_flashattention_broadcast_mqa,8,64,4,fwd,False,True,0.0008113102250629,0.2834486961364746,10.587731211367428,0.9912109375,91.259765625,,,,,,
2048,Custom MQA Kernel,custom_mqa_kernel,8,64,4,fwd,False,True,0.0017621599833170575,0.2760009765625,19.49864864330982,0.00244140625,0.443267822265625,,,,,,
2048,Naive Pytorch MQA,naive_mqa_pytorch,8,64,4,fwd,False,True,0.015179871559143066,1.1505126953125,2.2635065279787963,0.00048828125,0.15411376953125,,,,,,
2048,Pytorch SDPA (K/V Expanded for MQA),sdpa_expanded_for_mqa,8,64,4,fwd,False,True,0.0014477028335843766,0.2894296646118164,23.733971897346162,0.0,0.0,,,,,,
2048,Custom Kernel MHA (K/V Expanded for MQA),custom_kernel_mha_expanded_for_mqa,8,64,4,fwd,False,True,0.0019778080185254413,0.2896728515625,17.372635789805813,0.0015869140625,0.443267822265625,,,,,,
2048,Pip FlashAttention MQA (Broadcast),pip_flashattention_broadcast_mqa,8,64,4,fwd,False,True,0.002926639974117279,0.3089613914489746,11.740336587988907,0.8623046875,90.966796875,,,,,,
4096,Custom MQA Kernel,custom_mqa_kernel,8,64,4,fwd,False,True,0.00673796796798706,0.2940673828125,20.397685789690584,0.00152587890625,0.5756378173828125,,,,,,
4096,Naive Pytorch MQA,naive_mqa_pytorch,8,64,4,fwd,False,True,,,,,,,,,,,
4096,Pytorch SDPA (K/V Expanded for MQA),sdpa_expanded_for_mqa,8,64,4,fwd,False,True,0.0056553280353546145,0.3209238052368164,24.30256080863786,0.0,0.0,,,,,,
4096,Custom Kernel MHA (K/V Expanded for MQA),custom_kernel_mha_expanded_for_mqa,8,64,4,fwd,False,True,0.00745579195022583,0.3214111328125,18.433850406439664,0.001220703125,0.5748748779296875,,,,,,
4096,Pip FlashAttention MQA (Broadcast),pip_flashattention_broadcast_mqa,8,64,4,fwd,False,True,0.011175488471984863,0.3599867820739746,12.298250212197628,0.9482421875,91.2109375,,,,,,
8192,Custom MQA Kernel,custom_mqa_kernel,8,64,4,fwd,False,True,0.027298656463623047,0.3302001953125,20.138566695418863,0.0013427734375,0.7537841796875,,,,,,
8192,Naive Pytorch MQA,naive_mqa_pytorch,8,64,4,fwd,False,True,,,,,,,,,,,
8192,Pytorch SDPA (K/V Expanded for MQA),sdpa_expanded_for_mqa,8,64,4,fwd,False,True,0.022247392654418944,0.3839120864868164,24.711022205058416,0.0,0.0,,,,,,
8192,Custom Kernel MHA (K/V Expanded for MQA),custom_kernel_mha_expanded_for_mqa,8,64,4,fwd,False,True,0.029129919052124024,0.3848876953125,18.872548629616404,0.0013427734375,0.7518768310546875,,,,,,
8192,Pip FlashAttention MQA (Broadcast),pip_flashattention_broadcast_mqa,8,64,4,fwd,False,True,0.04300137710571289,0.4620375633239746,12.784609491377497,0.484619140625,90.966796875,,,,,,
